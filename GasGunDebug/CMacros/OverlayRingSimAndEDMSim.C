// Arrays

vector<float> pTotLAB = {5.49945005e-04, 5.99940006e-04, 4.99950005e-04, 5.49945005e-04,
        6.99930007e-04, 4.89951005e-04, 4.59954005e-04, 4.89951005e-04,
        5.69943006e-04, 5.79942006e-04, 5.39946005e-04, 5.99940006e-04,
        5.19948005e-04, 5.49945005e-04, 4.89951005e-04, 5.59944006e-04,
        5.59944006e-04, 6.19938006e-04, 3.79962004e-04, 5.79942006e-04,
        5.19948005e-04, 4.09959004e-04, 5.99940006e-04, 4.59954005e-04,
        5.39946005e-04, 5.79942006e-04, 5.39946005e-04, 4.49955004e-04,
        5.89941006e-04, 5.79942006e-04, 6.49935006e-04, 5.89941006e-04,
        5.29947005e-04, 5.29947005e-04, 4.99950005e-04, 4.29957004e-04,
        4.89951005e-04, 6.79932007e-04, 3.79962004e-04, 7.09929007e-04,
        4.79952005e-04, 6.69933007e-04, 4.79952005e-04, 3.99960004e-04,
        4.39956004e-04, 6.39936006e-04, 4.39956004e-04, 5.09949005e-04,
        5.09949005e-04, 5.69943006e-04, 4.69953005e-04, 4.59954005e-04,
        6.09939006e-04, 4.69953005e-04, 4.69953005e-04, 5.89941006e-04,
        3.89961004e-04, 4.49955004e-04, 5.09949005e-04, 5.09949005e-04,
        5.49945005e-04, 4.39956004e-04, 5.49945005e-04, 4.89951005e-04,
        6.39936006e-04, 4.09959004e-04, 4.29957004e-04, 5.09949005e-04,
        4.89951005e-04, 4.29957004e-04, 5.39946005e-04, 5.19948005e-04,
        4.49955004e-04, 3.19968003e-04, 4.59954005e-04, 4.59954005e-04,
        5.39946005e-04, 4.29957004e-04, 4.09959004e-04, 4.99950005e-04,
        3.99960004e-04, 4.69953005e-04, 4.69953005e-04, 4.49955004e-04,
        4.39956004e-04, 5.59944006e-04, 4.79952005e-04, 3.99960004e-04,
        4.69953005e-04, 4.69953005e-04, 6.29937006e-04, 4.39956004e-04,
        5.29947005e-04, 4.29957004e-04, 6.09939006e-04, 3.89961004e-04,
        3.89961004e-04, 4.99950005e-04, 4.19958004e-04, 5.09949005e-04,
        3.69963004e-04, 5.39946005e-04, 3.89961004e-04, 5.09949005e-04,
        3.99960004e-04, 4.79952005e-04, 3.39966003e-04, 3.19968003e-04,
        3.89961004e-04, 4.79952005e-04, 3.29967003e-04, 4.39956004e-04,
        5.49945005e-04, 3.99960004e-04, 4.19958004e-04, 3.89961004e-04,
        3.19968003e-04, 4.29957004e-04, 3.59964004e-04, 4.29957004e-04,
        2.69973003e-04, 4.59954005e-04, 3.39966003e-04, 3.99960004e-04,
        3.49965003e-04, 5.19948005e-04, 4.99950005e-04, 4.19958004e-04,
        3.89961004e-04, 3.59964004e-04, 3.59964004e-04, 3.39966003e-04,
        3.09969003e-04, 3.69963004e-04, 3.09969003e-04, 2.69973003e-04,
        3.89961004e-04, 4.39956004e-04, 4.29957004e-04, 3.99960004e-04,
        2.59974003e-04, 4.09959004e-04, 4.49955004e-04, 4.59954005e-04,
        3.39966003e-04, 4.59954005e-04, 3.79962004e-04, 3.89961004e-04,
        3.59964004e-04, 3.79962004e-04, 3.49965003e-04, 3.99960004e-04,
        3.99960004e-04, 4.49955004e-04, 4.29957004e-04, 3.69963004e-04,
        4.19958004e-04, 4.99950005e-04, 3.39966003e-04, 3.89961004e-04,
        3.39966003e-04, 3.29967003e-04, 4.09959004e-04, 3.09969003e-04,
        2.69973003e-04, 3.09969003e-04, 2.99970003e-04, 3.39966003e-04,
        2.69973003e-04, 3.99960004e-04, 2.99970003e-04, 3.29967003e-04,
        3.19968003e-04, 2.39976002e-04, 3.49965003e-04, 3.69963004e-04,
        3.19968003e-04, 2.59974003e-04, 3.79962004e-04, 3.59964004e-04,
        2.99970003e-04, 2.69973003e-04, 2.79972003e-04, 2.29977002e-04,
        1.99980002e-04, 3.49965003e-04, 3.39966003e-04, 3.29967003e-04,
        3.09969003e-04, 3.29967003e-04, 2.39976002e-04, 2.69973003e-04,
        3.19968003e-04, 2.79972003e-04, 2.49975002e-04, 2.29977002e-04,
        3.19968003e-04, 1.99980002e-04, 2.29977002e-04, 3.39966003e-04,
        1.09989001e-04, 1.99980002e-04, 2.29977002e-04, 2.39976002e-04,
        2.09979002e-04, 1.59984002e-04, 2.39976002e-04, 2.69973003e-04,
        2.69973003e-04, 2.29977002e-04, 2.99970003e-04, 2.49975002e-04,
        1.99980002e-04, 2.99970003e-04, 1.69983002e-04, 2.19978002e-04,
        1.69983002e-04, 1.89981002e-04, 2.49975002e-04, 2.09979002e-04,
        2.19978002e-04, 1.99980002e-04, 1.99980002e-04, 1.39986001e-04,
        2.19978002e-04, 2.19978002e-04, 1.89981002e-04, 1.39986001e-04,
        1.09989001e-04, 1.89981002e-04, 1.79982002e-04, 1.89981002e-04,
        1.79982002e-04, 1.69983002e-04, 1.99980002e-04, 1.29987001e-04,
        1.99980002e-04, 1.89981002e-04, 1.09989001e-04, 1.29987001e-04,
        1.59984002e-04, 1.09989001e-04, 1.89981002e-04, 1.59984002e-04,
        1.59984002e-04, 1.59984002e-04, 1.49985001e-04, 9.99900010e-05,
        9.99900010e-05, 1.69983002e-04, 5.99940006e-05, 1.19988001e-04,
        9.99900010e-05, 8.99910009e-05, 9.99900010e-05, 1.09989001e-04,
        1.79982002e-04, 6.99930007e-05, 8.99910009e-05, 1.29987001e-04,
        1.09989001e-04, 7.99920008e-05, 9.99900010e-05, 6.99930007e-05,
        1.09989001e-04, 4.99950005e-05, 8.99910009e-05, 6.99930007e-05,
        6.99930007e-05, 8.99910009e-05, 9.99900010e-05, 7.99920008e-05,
        9.99900010e-05, 1.09989001e-04, 1.19988001e-04, 5.99940006e-05,
        6.99930007e-05, 4.99950005e-05, 1.39986001e-04, 1.09989001e-04,
        4.99950005e-05, 1.09989001e-04, 4.99950005e-05, 7.99920008e-05,
        6.99930007e-05, 4.99950005e-05, 7.99920008e-05, 3.99960004e-05,
        7.99920008e-05, 3.99960004e-05, 2.99970003e-05, 2.99970003e-05,
        4.99950005e-05, 2.99970003e-05, 9.99900010e-06, 2.99970003e-05,
        1.99980002e-05, 4.99950005e-05, 1.99980002e-05, 1.99980002e-05,
        1.99980002e-05, 1.99980002e-05, 0.00000000e+00, 9.99900010e-06,
        2.99970003e-05, 0.00000000e+00, 1.99980002e-05, 9.99900010e-06,
        0.00000000e+00};

vector<float> pXLAB = {0.        , 0.        , 0.        , 0.        , 0.00013999,
        0.00286971, 0.00665933, 0.01010899, 0.0139586 , 0.01553845,
        0.01587841, 0.01388861, 0.01083892, 0.00668933, 0.00326967,
        0.00015998, 0.        , 0.        , 0.        , 0.        };

vector<float> pyLAB = { 0.        , 0.        , 0.        , 0.        , 0.00020998,
        0.00305969, 0.00713929, 0.01067893, 0.01360864, 0.01539846,
        0.01525847, 0.01365863, 0.01053895, 0.00748925, 0.00276972,
        0.00018998, 0.        , 0.        , 0.        };

vector<float> pyLAB_0 = {0.00073617, 0.00095269, 0.00126665, 0.00188373, 0.00255494,
        0.0036592 , 0.00385407, 0.00591101, 0.00868247, 0.01991989,
        0.02040706, 0.00895312, 0.00606257, 0.0042438 , 0.00326946,
        0.00257659, 0.0018729 , 0.00154812, 0.00097434, 0.00067121};

vector<float> pzLAB = {5.69943006e-04, 5.89941006e-04, 5.59944006e-04, 5.29947005e-04,
        6.69933007e-04, 4.69953005e-04, 4.99950005e-04, 4.89951005e-04,
        5.59944006e-04, 5.79942006e-04, 5.29947005e-04, 5.99940006e-04,
        5.39946005e-04, 5.39946005e-04, 4.79952005e-04, 5.59944006e-04,
        5.69943006e-04, 6.09939006e-04, 3.89961004e-04, 5.99940006e-04,
        4.79952005e-04, 4.19958004e-04, 6.09939006e-04, 4.79952005e-04,
        5.89941006e-04, 5.09949005e-04, 5.59944006e-04, 4.49955004e-04,
        5.89941006e-04, 5.79942006e-04, 6.29937006e-04, 6.09939006e-04,
        5.29947005e-04, 5.29947005e-04, 4.79952005e-04, 4.39956004e-04,
        5.49945005e-04, 6.29937006e-04, 4.09959004e-04, 6.69933007e-04,
        5.49945005e-04, 6.19938006e-04, 4.69953005e-04, 3.89961004e-04,
        4.49955004e-04, 7.19928007e-04, 3.89961004e-04, 5.69943006e-04,
        4.19958004e-04, 5.99940006e-04, 4.59954005e-04, 4.89951005e-04,
        6.19938006e-04, 4.59954005e-04, 4.59954005e-04, 6.09939006e-04,
        3.49965003e-04, 5.09949005e-04, 4.99950005e-04, 5.09949005e-04,
        5.49945005e-04, 4.09959004e-04, 5.99940006e-04, 4.69953005e-04,
        6.19938006e-04, 3.79962004e-04, 4.49955004e-04, 5.49945005e-04,
        4.99950005e-04, 3.99960004e-04, 4.99950005e-04, 5.29947005e-04,
        4.69953005e-04, 3.69963004e-04, 4.69953005e-04, 4.19958004e-04,
        5.59944006e-04, 4.19958004e-04, 4.19958004e-04, 4.59954005e-04,
        5.09949005e-04, 4.49955004e-04, 4.89951005e-04, 4.09959004e-04,
        4.99950005e-04, 4.79952005e-04, 4.89951005e-04, 4.69953005e-04,
        4.49955004e-04, 5.39946005e-04, 5.79942006e-04, 4.59954005e-04,
        5.19948005e-04, 4.69953005e-04, 5.59944006e-04, 3.79962004e-04,
        3.49965003e-04, 5.49945005e-04, 4.29957004e-04, 4.99950005e-04,
        3.79962004e-04, 4.79952005e-04, 4.49955004e-04, 4.69953005e-04,
        3.69963004e-04, 4.39956004e-04, 3.89961004e-04, 3.19968003e-04,
        4.69953005e-04, 3.89961004e-04, 3.89961004e-04, 4.29957004e-04,
        5.69943006e-04, 4.29957004e-04, 3.99960004e-04, 3.79962004e-04,
        3.09969003e-04, 4.29957004e-04, 3.79962004e-04, 3.59964004e-04,
        2.59974003e-04, 4.89951005e-04, 3.09969003e-04, 4.19958004e-04,
        4.09959004e-04, 5.39946005e-04, 3.99960004e-04, 4.19958004e-04,
        4.09959004e-04, 3.79962004e-04, 3.39966003e-04, 2.79972003e-04,
        3.79962004e-04, 3.49965003e-04, 3.29967003e-04, 2.09979002e-04,
        4.19958004e-04, 4.19958004e-04, 4.59954005e-04, 3.49965003e-04,
        2.59974003e-04, 4.09959004e-04, 4.69953005e-04, 4.69953005e-04,
        3.69963004e-04, 4.09959004e-04, 3.89961004e-04, 3.89961004e-04,
        3.79962004e-04, 3.49965003e-04, 3.99960004e-04, 3.79962004e-04,
        3.99960004e-04, 4.69953005e-04, 4.19958004e-04, 2.89971003e-04,
        4.49955004e-04, 4.69953005e-04, 3.69963004e-04, 3.79962004e-04,
        2.99970003e-04, 3.79962004e-04, 4.09959004e-04, 2.59974003e-04,
        2.69973003e-04, 3.39966003e-04, 2.99970003e-04, 2.89971003e-04,
        3.69963004e-04, 3.39966003e-04, 2.39976002e-04, 3.49965003e-04,
        3.09969003e-04, 2.69973003e-04, 3.39966003e-04, 3.89961004e-04,
        2.99970003e-04, 2.39976002e-04, 3.89961004e-04, 3.39966003e-04,
        3.29967003e-04, 2.39976002e-04, 3.09969003e-04, 1.99980002e-04,
        2.39976002e-04, 3.39966003e-04, 3.69963004e-04, 2.59974003e-04,
        3.19968003e-04, 3.49965003e-04, 2.09979002e-04, 2.69973003e-04,
        3.39966003e-04, 2.59974003e-04, 2.49975002e-04, 2.49975002e-04,
        2.89971003e-04, 2.19978002e-04, 2.49975002e-04, 2.89971003e-04,
        1.49985001e-04, 1.79982002e-04, 2.09979002e-04, 2.49975002e-04,
        1.99980002e-04, 1.99980002e-04, 2.29977002e-04, 2.39976002e-04,
        2.69973003e-04, 2.29977002e-04, 2.99970003e-04, 2.49975002e-04,
        2.29977002e-04, 2.79972003e-04, 1.69983002e-04, 2.09979002e-04,
        1.79982002e-04, 1.89981002e-04, 2.49975002e-04, 1.89981002e-04,
        2.19978002e-04, 2.09979002e-04, 2.09979002e-04, 1.49985001e-04,
        2.09979002e-04, 2.19978002e-04, 1.79982002e-04, 1.39986001e-04,
        1.29987001e-04, 1.59984002e-04, 1.89981002e-04, 1.89981002e-04,
        1.79982002e-04, 1.69983002e-04, 1.89981002e-04, 1.49985001e-04,
        2.09979002e-04, 1.59984002e-04, 1.09989001e-04, 1.49985001e-04,
        1.49985001e-04, 9.99900010e-05, 1.99980002e-04, 1.79982002e-04,
        1.49985001e-04, 1.49985001e-04, 1.49985001e-04, 9.99900010e-05,
        8.99910009e-05, 1.69983002e-04, 7.99920008e-05, 9.99900010e-05,
        9.99900010e-05, 8.99910009e-05, 9.99900010e-05, 1.09989001e-04,
        1.89981002e-04, 6.99930007e-05, 8.99910009e-05, 1.19988001e-04,
        1.09989001e-04, 8.99910009e-05, 8.99910009e-05, 8.99910009e-05,
        8.99910009e-05, 4.99950005e-05, 8.99910009e-05, 7.99920008e-05,
        5.99940006e-05, 8.99910009e-05, 9.99900010e-05, 9.99900010e-05,
        7.99920008e-05, 1.19988001e-04, 1.29987001e-04, 3.99960004e-05,
        6.99930007e-05, 4.99950005e-05, 1.39986001e-04, 1.09989001e-04,
        4.99950005e-05, 1.09989001e-04, 4.99950005e-05, 7.99920008e-05,
        6.99930007e-05, 4.99950005e-05, 7.99920008e-05, 3.99960004e-05,
        7.99920008e-05, 3.99960004e-05, 2.99970003e-05, 2.99970003e-05,
        4.99950005e-05, 2.99970003e-05, 9.99900010e-06, 2.99970003e-05,
        1.99980002e-05, 4.99950005e-05, 1.99980002e-05, 1.99980002e-05,
        1.99980002e-05, 1.99980002e-05, 0.00000000e+00, 9.99900010e-06,
        2.99970003e-05, 0.00000000e+00, 1.99980002e-05, 9.99900010e-06,
        0.00000000e+00};

vector<float> pTotMRF = {0.0009899 , 0.00775922, 0.01833817, 0.02766723, 0.03462654,
        0.01061894, 0.        , 0.        , 0.        };

vector<float> pXMRF = { 0.        , 0.        , 0.        , 0.        , 0.00012999,
        0.00310969, 0.00706929, 0.01111889, 0.01378862, 0.01530847,
        0.0150385 , 0.01377862, 0.01033897, 0.00707929, 0.00309969,
        0.00013999, 0.        , 0.        , 0.        };

vector<float> pyMRF = {0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        8.99910009e-05, 3.07969203e-03, 6.80931907e-03, 1.09089091e-02,
        1.34486551e-02, 1.56784322e-02, 1.49285071e-02, 1.42785721e-02,
        1.07089291e-02, 6.78932107e-03, 3.13968603e-03, 1.39986001e-04,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00};

vector<float> pzMRF = {0.        , 0.        , 0.        , 0.        , 0.00016998,
        0.00292971, 0.00714929, 0.0110289 , 0.01370863, 0.0149985 ,
        0.01567843, 0.01389861, 0.01066893, 0.00660934, 0.0030497 ,
        0.00010999, 0.        , 0.        , 0.        };

vector<vector<float>> LAB_ = {pTotLAB, pXLAB, pyLAB, pzLAB}; 
vector<vector<float>> MRF_ = {pTotMRF, pXMRF, pyMRF, pzMRF}; 

vector<TH1F*> GetRingSimHists(string inputName) {

	cout<<"\nGetting ringSim hists"<<endl; 

	TFile *fin = TFile::Open(inputName.c_str());

	string name = "Positrons/h_posMom"; 
	vector<string> labels_ = {"", "X", "Y", "Z"};

	vector<TH1F*> h_ringSim_;

	for (int i = 0; i<labels_.size(); i++) {

		TH1F *hist = (TH1F*)fin->Get((name+labels_.at(i)).c_str());

		cout<<"Got hist "<<name+labels_.at(i)<<", "<<hist<<endl;

		h_ringSim_.push_back(hist);

	}

	return h_ringSim_;

}

vector<TH1F*> GetEDMSimHists(string frame) { 

	cout<<"\nGetting edmSim hists"<<endl;

	vector<vector<float>> data_;

	TH1F *h_posMom;
   	TH1F *h_posMomX;
   	TH1F *h_posMomY;
   	TH1F *h_posMomZ;

	if(frame=="LAB") {

		data_ = LAB_;
		h_posMom = new TH1F("h_posMom",";Positron momentum [MeV];Entries",310,0,3100);
   		h_posMomX = new TH1F("h_posMomX",";Positron momentum X [MeV];Entries",20,-100,100);
   		h_posMomY = new TH1F("h_posMomY",";Positron momentum Y [MeV];Entries",20,-100,100);
   		h_posMomZ = new TH1F("h_posMomZ",";Positron momentum Z [MeV];Entries",620,-3100,3100);

   	} else if(frame=="MRF") {

   		data_ = MRF_;

   		h_posMom = new TH1F("h_posMom",";Positron momentum [MeV];Entries",10,0,100);
   		h_posMomX = new TH1F("h_posMomX",";Positron momentum X [MeV];Entries",20,-100,100);
   		h_posMomY = new TH1F("h_posMomY",";Positron momentum Y [MeV];Entries",20,-100,100);
   		h_posMomZ = new TH1F("h_posMomZ",";Positron momentum Z [MeV];Entries",20,-100,100);

   	}

   	vector<TH1F*> hists_ = {h_posMom, h_posMomX, h_posMomY,h_posMomZ};

	for (int i = 0; i<data_.size(); i++) { 

		// Get array 
		vector<float> entries_ = data_.at(i);

		for(int j = 0; j < entries_.size(); j++) {

			//cout<<"Setting bin "<<j+1<<" with "<<entries_.at(j)<<endl;

			hists_.at(i)->SetBinContent(j+1,entries_.at(j));

		}

		cout<<"Filled hist "<<hists_.at(i)<<endl;

	}

	TCanvas *c = new TCanvas();
	hists_.at(0)->Draw();
	c->SaveAs("tmp.png");


	return hists_; 

}

void DrawHists(TH1F* h_ringSim, TH1F* h_edmSim, string title, string fname) { 

	TCanvas *c = new TCanvas("c","c",800,600);

	h_ringSim->SetTitle(title.c_str());

	gStyle->SetOptStat(0);
			
	h_ringSim->GetXaxis()->SetTitleSize(.04);
	h_ringSim->GetYaxis()->SetTitleSize(.04);
	h_ringSim->GetXaxis()->SetTitleOffset(1.1);
	h_ringSim->GetYaxis()->SetTitleOffset(1.1);
	h_ringSim->GetXaxis()->CenterTitle(1);
	h_ringSim->GetYaxis()->CenterTitle(1);
	h_ringSim->GetYaxis()->SetMaxDigits(4);

	h_ringSim->SetLineColor(kBlack);
	h_edmSim->SetLineColor(kRed);


	//c->SetRightMargin(0.13);

	h_ringSim->Draw("HIST E");
	h_edmSim->Draw("HIST E SAME");

	//h_edmSim->Draw("HIST E");
	//h_ringSim->Draw("HIST E SAME");
	


	TLegend *leg = new TLegend(.69, .69, .89, .89);//"0.69","0.69","0.89","0.89");

	leg->AddEntry(h_ringSim, "gm2ringsim");
	leg->AddEntry(h_edmSim, "EDMSim");

	leg->SetBorderSize(0);

	leg->Draw("SAME");

	c->SaveAs((fname+".C").c_str());
	c->SaveAs((fname+".pdf").c_str());
	c->SaveAs((fname+".png").c_str());

	delete c;

	return;
}


void Run(bool boost) { 

	string frame = "";
	if(boost) frame = "MRF"; 
	else frame = "LAB";

	vector<TH1F*> h_ringSim_ = GetRingSimHists("../plots/decayNTuplePlots_1e4_xPol_"+frame+".root");
	vector<TH1F*> h_edmSim_ = GetEDMSimHists(frame); 

	cout<<"\nOverlaying"<<endl;

	vector<string> labels_ = {"", "X", "Y", "Z"};

	for(int i = 0; i<h_ringSim_.size(); i++) { 


		string name = "h_posMom"+labels_.at(i);

		if(boost) {

			//if(i == 0) h_ringSim_.at(i)->GetXaxis()->SetRangeUser(0,100);
			//if(i == 3) h_ringSim_.at(i)->GetXaxis()->SetRangeUser(-100,100);

			name += "_MRF";

		} else name += "_LAB";

		// Normalise

		// Deal with error bars
		//h_ringSim_.at(i)->Sumw2(kTRUE);
		//h_edmSim_.at(i)->Sumw2(kTRUE);

		h_ringSim_.at(i)->Scale(1/h_ringSim_.at(i)->GetBinContent(h_ringSim_.at(i)->GetMaximumBin()));//h_ringSim_.at(i)->Integral());
		h_edmSim_.at(i)->Scale(1/h_edmSim_.at(i)->GetBinContent(h_edmSim_.at(i)->GetMaximumBin()));//h_edmSim_.at(i)->Integral());//h_edmSim_.at(i)->GetEntries());

		DrawHists(h_ringSim_.at(i), h_edmSim_.at(i), ";Positron momentum "+labels_.at(i)+" [MeV];Normalised units", "../Images/Overlay/"+name);

	}

	return;

}

void OverlayRingSimAndEDMSim() { 

	TH1::SetDefaultSumw2(kTRUE);

	bool boost = false;
	Run(boost);
 
	return;

}